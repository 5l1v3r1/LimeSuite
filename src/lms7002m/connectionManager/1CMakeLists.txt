set(ENABLE_USB_CONNECTION "YES" CACHE BOOL INTERNAL)

set(connectionManager_src_files
	ConnectionManager.cpp
	ConnectionCOM.cpp	
	ConnectionManager.h
	ConnectionCOM.h	
)

if(ENABLE_USB_CONNECTION)
	list(APPEND connectionManager_src_files ConnectionUSB.cpp ConnectionUSB.h)
    add_definitions(-DENABLE_USB_CONNECTION)
endif()

add_library(connectionManager STATIC ${connectionManager_src_files})
target_include_directories(connectionManager PUBLIC ${CMAKE_CURRENT_SOURCE_DIR})


if(WIN32 AND ENABLE_USB_CONNECTION)
	find_package(CyAPI REQUIRED)
	LINK_DIRECTORIES(${CYAPI_LIBRARIES})	
	include_directories(${CYAPI_INCLUDE_DIRS})
	set(CONNECTION_MANAGER_LIBS ${CYAPI_LIBRARIES} SetupAPI)
	target_link_libraries(connectionManager ${CONNECTION_MANAGER_LIBS})
	
endif()
if(UNIX AND ENABLE_USB_CONNECTION)	
	set(CONNECTION_MANAGER_LIBS usb-1.0 -lpthread)
	target_link_libraries(connectionManager ${CONNECTION_MANAGER_LIBS})
endif()


